var config = {};
var Action = require('./lib/action');


function Controller(fns,cfg){
	var self = this;
		restrict = fns.__restrict || {};
	
	for(var i in fns){
		if (i.indexOf('__') !== 0) {
			this[i] = function(req,res){
				new Action(fns[i],cfg,restrict[i]).func(req,res);
			}
		}
	}
};

module.exports = {
	create:function(fns){
		return new Controller(fns,config);
	},
	configure: function(cfg){
		config = cfg;
	}
};